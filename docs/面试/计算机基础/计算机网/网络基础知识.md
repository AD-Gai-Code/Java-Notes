# 网络基础知识

##  1. 面试网络知识的意义？
编程的时候并不需要编写`Socket`，并且底层服务已经很好的处理了数据包的解析。实际上网络知识就相当于框架底层知识，平时能够满足我们需求的时候并不会关心网络，但是如果性能没办法满足我们的需求时，就需要使用到网络知识。比如没办法判断程序为什么会变慢，是网络的原因还是其他原因，数据包有没有丢失，为什么会造成大量的`Close Wait`，为什么会出现大量的连接丢失等等。

##  2. 网络协议
###  国际标准化组织ISO制定的OSI七层开放式互联协议模型
![1](https://gitee.com/AD-Gai-Code/pic-go/raw/master/202110181719927.jpg)
*   物理层：首先要解决两台物理机之间的通信需求，机器A向机器B发送比特流，机器B能够接收这些比特流。物理层主要定义了物理设备的标准，如网线的类型、光纤的接口类型、各种传输介质的传输速率，但物理层指的并不是具体的传输媒介，其作用是传输比特流，即`0101`二进制数据，将他们转化为电流强弱来进行传输，到达目的地后再转换为`0101`机器码，此时用到数模转换器和模数转换器。这层数据是比特，网卡（网络适配器）工作在物理层。
*   数据链路层：在传输比特流的过程中会产生错传，数据传输不完整的可能，因此产生了数据链路层。数据链路层定义了如何格式化数据以进行传输，以及如何控制对物理介质的访问。数据链层通常还提供错误检测和纠正以确保数据传输的可靠性，本层将比特数据组成了帧，交换机工作在数据链路层，对帧解码，并根据帧中包含的信息把数据发送到正确的接收方。
*   网络层：随着网络节点的增加，点对点通信时需要经过多个节点，如何找到目标节点，如何选择最佳路径，此时便有了网络层。其主要功能是将网络地址翻译成对应的物理地址，并决定如何将数据从发送方路由到接收方，网络层通过综合考虑，发送优先权、网络拥塞程度、服务质量、可选路由的花费来决定从一个网络中节点A到另一个网络中节点B的最佳路径，由于网络层处理并智能指导数据传送，路由器连接网络各段，所以路由器属于网络层，此层的数据称为数据包。此层的协议有TCP/IP协议里边的IP协议。
*   传输层：随着网络通信需求的进一步扩大，通信过程中需要发送大量的数据，如海量文件传输需要很长时间，而网络在通信的过程中会中断很多次，此时为了保证传输大量文件的正确性，需要对发出去数据进行切分，切割为一个一个的段落，即`segment`进行发送。其中一个段落丢失应该怎么处理，需不需要重传，每个段落需要按照顺序到达么，这便是传输层需要解决的问题了。传输层解决了主机间的数据传输，数据间的传输可以是不同网络的，并且传输层解决了传输质量的问题，是`OSI`模型中最重要的一层。传输协议同时进行流量控制或是基于接收方可接收数据的快慢程度规定适当的发送速率。传输层按照网络能够处理的最大尺寸将较长数据包进行强制分割，例如以太网无法接收大于1500字节数据包，发送方节点的传输层将数据分割成较小的数据片同时对每一数据片安排序列号以便数据到达接收方节点的传输层时以正确的顺序重组，该过程称为排序。协议有`TCP/IP`协议中的`TCP协议`和`UDP协议`。
*   会话层：此时已经保证了给正确的计算机发送正确的封装过后的信息，但是用户级别的体验并不好，此时用户每次都需要调用TCP打包然后调用IP协议寻找路由然后发送，由此需要一个自动收发包，自动寻址的功能，于是产生了会话层。会话层的作用就是**建立和管理应用程序之间的通信。**
*   表示层：需要表示成`SESSION LAYER`来解决不同系统之间通信语法的问题，在表示层数据将按照网络能够理解的方法来进行格式化，这种格式化也因为网络类型使用的不同而不同。
*   应用层：此时发送方知道自己发送的是什么数据，转换成字节数组之后有多长，但接收方一无所知，所以产生了应用层的网络协议。应用层规定发送方和接收方必须使用一个固定长度的消息头，消息头必须使用某种固定的组成，而且消息头里必须记录消息体的长度等一系列信息以方便接收方能够正确的解析发送方发送的数据。此协议层有`TCP/IP`协议中的`HTTP`协议.
##  3. 数据处理流程
**先自上而下，后自下而上处理数据头部**
自上而下：添加下层协议所需要的首部或者尾部。
自下而上：拆开首部和尾部。
![2021-10-11_172443](https://gitee.com/AD-Gai-Code/pic-go/raw/master/202110181720768.png)

从应用层开始都会对要传输的数据头部进行处理，加上本层的一些信息，最终由物理层通过以太网、电缆等介质将数据解析成比特流在网络中传输，数据传递到目标地址后将自低而上的将数据头部解析分离出来。
![2](https://gitee.com/AD-Gai-Code/pic-go/raw/master/202110181720062.jpg)

##  4.TCP/IP(传输/控制协议)
`OSI`模型并不是一个标准，而是制定标准时使用的概念型框架。

`OSI`的“实现”：`TCP/IP`网际协议群。
![3](https://gitee.com/AD-Gai-Code/pic-go/raw/master/202110181720496.jpg)
![4](https://gitee.com/AD-Gai-Code/pic-go/raw/master/202110181721601.jpg)

